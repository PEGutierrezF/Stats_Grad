---
title: "Dependent t-tests"
subtitle: ""
author: "Pablo E. Guti\u00E9rrez-Fonseca"
institute: ""
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: [default, "css/nhsr.css", "css/nhsr-fonts.css", "css/custom.css"]
    nature:
      highlightLanguage: r
      highlightStyle: github
      highlightLines: true
      highlightSpans: true 
      countIncrementalSlides: true
      ratio: "16:9"
    includes:
      after_body: [css/insert-logo.html]
xaringanExtra:
    use_panelset: true
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(readr)
library(lessR)
library(ggplot2)
library(tidyr)
library(effectsize) # Cohen’s d for two-sample t-test
xaringanExtra::use_panelset()
```


# Dependent t-test

- Used when we have dependent samples – matched, paired or tied somehow
  - Repeated measures
  - Brother & sister, husband & wife
  - Left hand, right hand, etc.

- Useful to **control individual differences**.  Can result in more powerful test than independent samples t-test.


---
# Import your data

```{r, message=FALSE, warning=FALSE}
ice_before_after <- read_csv("Lecturer Practice/ice_storm_data_before_and_after.csv") 
head(ice_before_after)
```


---
# Run descriptive statistics

```{r, message=FALSE, warning=FALSE}
pivot(ice_before_after, c(IQR, skew, kurtosis, mean, sd, var), Ice)
pivot(ice_before_after, c(IQR, skew, kurtosis, mean, sd, var), Control)
```


---
#  Test for normality 
```{r, message=FALSE, warning=FALSE, highlight.output =5}
shapiro.test(ice_before_after$Control)
shapiro.test(ice_before_after$Ice)
```

---
# Test for equal variance


```{r, message=FALSE, warning=FALSE, highlight.output =5}
var.test(ice_before_after$Control, ice_before_after$Ice)
```

---
# Data visualization

.panelset[
.panel[.panel-name[R Code]
```{r oplot, fig.show='hide', fig.width=5.5, fig.height=5.5}
# Convert data to long format for ggplot
ice_before_after_long <- ice_before_after %>%
  pivot_longer(cols = c("Control", "Ice"), 
               names_to = "Condition", 
               values_to = "Value")
ggplot(ice_before_after_long, aes(x = Condition, y = Value, fill = Condition)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 20, size = 4, color = "red", fill = "red") +
  theme_minimal() +
  labs(title = "Comparison of Control and Ice Conditions",
       x = "Condition",
       y = "Value") +
  scale_fill_manual(values = c("lightblue", "lightgreen"))
```
]

.panel[.panel-name[Plot]
![](`r knitr::fig_chunk("oplot", ".png")`)
]
]

---

# Mental check for paired or unpaired

Paired!

---

#8. Run the code for the appropriate test

```{r tx-wrangle, highlight.output = 5}
t.test(ice_before_after$Control, ice_before_after$Ice,
alternative = c("two.sided"),
mu = 0, 
paired = TRUE, 
var.equal = TRUE,
conf.level = 0.95)
```

---
# Effect size 

```{r}
library(effectsize)
cohens_d(ice_before_after$Control, ice_before_after$Ice, data=Ice)
```

---

