<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Factorial ANOVA</title>
    <meta charset="utf-8" />
    <meta name="author" content="Pablo E. Gutiérrez-Fonseca" />
    <meta name="date" content="2024-10-19" />
    <script src="libs/header-attrs-2.28/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/panelset-0.3.0/panelset.css" rel="stylesheet" />
    <script src="libs/panelset-0.3.0/panelset.js"></script>
    <link rel="stylesheet" href="css/nhsr.css" type="text/css" />
    <link rel="stylesheet" href="css/nhsr-fonts.css" type="text/css" />
    <link rel="stylesheet" href="css/custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Factorial ANOVA
]
.subtitle[
## (ANOVA)
]
.author[
### Pablo E. Gutiérrez-Fonseca
]
.date[
### 2024-10-19
]

---



# What is a Full Factorial Experiment?
- A factorial experiment allows researchers to study the joint effect of two or more factors on a dependent variable.

- Factorial designs are an extension of single factor ANOVA designs in which additional factors are added such that each level of one factor is applied to all levels of the other factor(s) and these combinations are replicated.

---
# Treatment Groups in Full Factorial Design
- Factor A has two levels, factor B has three levels. Therefore, the full factorial design has 2 x 3 = 6 treatment groups.

|         | B1            | B2            | B3            |
|---------|---------------|---------------|---------------|
| A1      | Group 1      | Group 2      | Group 3      |
| A2      | Group 4      | Group 5      | Group 6      |

---

# One-way ANOVA Summary Table

| Source of&lt;br/&gt; Variation          |   Degrees of&lt;br/&gt; Freedom (DF)   |     Sum of Squares&lt;br/&gt; (SS)     |     Mean Square&lt;br/&gt; (MS)   |        F-value        |
|----------------------------------|:----------------------------------:|:----------------------------------:|:---------------------------:|:---------------------:|
| **Between&lt;br/&gt; Groups**          |          `\(c - 1\)`                  |             `\(SSB\)`                 |    `\(MSB = \frac{SSB}{c - 1}\)`  |       `\(\frac{MSB}{MSW}\)`  |
| **Within&lt;br/&gt; Groups**           |          `\(n - c\)`                  |             `\(SSW\)`                 |    `\(MSW = \frac{SSW}{n - c}\)`  |                       |
| **Total**                        |          `\(n - 1\)`                  |      `\(SST = SSB + SSW\)`            |                           |                       |

- `\(c\)` = number of groups.  
- `\(n\)` = number of observations.

---
# Factorial ANOVA Summary Table

| Source of&lt;br/&gt; Variation          |   Degrees of&lt;br/&gt; Freedom (DF)   |     Sum of Squares&lt;br/&gt; (SS)     |     Mean Square&lt;br/&gt; (MS)   |        F-value        |
|----------------------------------|:----------------------------------:|:----------------------------------:|:---------------------------:|:---------------------:|
| **Factor A**                     |          `\(a - 1\)`                  |             `\(SSA\)`                 |    `\(MSA = \frac{SSA}{a - 1}\)`  |       `\(\frac{MSA}{MSW}\)`  |
| **Factor B**                     |          `\(b - 1\)`                  |             `\(SSB\)`                 |    `\(MSB = \frac{SSB}{b - 1}\)`  |       `\(\frac{MSB}{MSW}\)`  |
| **Interaction (A × B)**         |          `\((a - 1)(b - 1)\)`         |             `\(SS_{AB}\)`             |    `\(MS_{AB} = \frac{SS_{AB}}{(a - 1)(b - 1)}\)` |   `\(\frac{MS_{AB}}{MSW}\)`  |
| **Within&lt;br/&gt; Groups**           |          `\(N - ab\)`                 |             `\(SSW\)`                 |    `\(MSW = \frac{SSW}{N - ab}\)`  |                       |
| **Total**                        |          `\(N - 1\)`                  |      `\(SST = SSA + SSB + SS_{AB} + SSW\)`            |                           |                       |

- `\(a\)` = number of levels in Factor A.  
- `\(b\)` = number of levels in Factor B.  
- `\(N\)` = total number of observations.

---
# When do you do a Factorial ANOVA
- You have a continuous response variable.

- You have two or more categorical treatment variables (factors).

  - You want to simultaneously test for differences in the response variable across these factors.

  - You want to block for a source of known variability to better isolate the effect of the main variables of interest.

  - You suspect there may be interactions between the factors that could influence the response, potentially hiding the true relationships.

---
# ANOVA Terminology

- **One-Way ANOVA**: Used when you have one treatment variable. The non-parametric alternative is the **Kruskal-Wallis test**.

- **Factorial ANOVA**: Applied when there are two or more treatment variables. The name reflects the number of groups and variables, e.g., a 2x3 Factorial ANOVA. The non-parametric alternative is Friedman’s k-way test.

- **Full Factorial ANOVA**: Used when you are also considering interaction terms between variables. This analysis examines the main effects and interactions among factors.

---
# Factorial ANOVA ANOVA test hypotheses

- Two-way ANOVA Test Hypotheses:

  - `\(H_{0A}: \mu_{A1} = \mu_{A2} = \dots = \mu_{Ak}\)` 
(There is no difference in the means of factor A).

  - `\(H_{0B}: \mu_{B1} = \mu_{B2} = \dots = \mu_{Bk}\)` 
(There is no difference in the means of factor B).

  - `\(H_{0AB}\)`: There is no interaction between factors A and B.


---
# Factorial ANOVA ANOVA test hypotheses

- Two-way ANOVA Test Hypotheses:

  - `\(H_{0A}: \mu_{A1} = \mu_{A2} = \dots = \mu_{Ak}\)` 
(There is no difference in the means of factor A).

  - `\(H_{0B}: \mu_{B1} = \mu_{B2} = \dots = \mu_{Bk}\)` 
(There is no difference in the means of factor B).

  - `\(H_{0AB}\)`: There is no interaction between factors A and B.

- Alternative Hypotheses:

  - `\(H_{1A}\)`: The means for factor A are not equal.

  - `\(H_{1B}\)`: The means for factor B are not equal.

  - `\(H_{1AB}\)`: There is an interaction between factors A and B.

---
# Assumptions of two-way ANOVA test
- Two-way ANOVA, like all ANOVA tests, makes the following assumptions:

- The observations within each cell are normally distributed.
- The variances across groups are equal (homogeneity of variances).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLanguage": "r",
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(css/logo.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 110px;
  height: 128px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
